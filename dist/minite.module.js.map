{"version":3,"file":"minite.module.js","sources":["../src/element.js","../src/reducer.js","../src/index.js","../src/hooks.js"],"sourcesContent":["/**\n * Check if tag name is svg\n * @param {String} tagName\n */\nfunction isSVG(tagName) {\n  const patt = new RegExp('^' + tagName + '$', 'i')\n  const SVGTags = ['path', 'svg', 'use', 'g']\n  return SVGTags.some(tag => patt.test(tag))\n}\n\n/**\n * Inline style\n * @param {Object} styles\n */\nfunction objectToStyleString(styles) {\n  return Object.keys(styles)\n    .map(prop => {\n      // convert camelCase to kebab-case\n      const newProp = prop.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g, '$1-$2').toLowerCase();\n      return `${newProp}: ${styles[prop]}`\n    })\n    .join(';')\n}\n\nexport const createElement = function (tagName, attrs, ...children) {\n\n  // Flexibility, can skip attrs and pass as child\n  if (Array.isArray(attrs)) children = attrs\n  else if (typeof attrs === 'string') children.push(attrs)\n\n  // For re-usable / nested jsx component\n  if (typeof tagName === 'function') return tagName(attrs, children)\n  \n  // If tagName are 'x' it became fragment\n  if (tagName === 'x') return children\n \n  // Lowercasing all attribute name, onClick -> onclick\n  // Support for both class & className\n  if (typeof attrs === 'object') {\n    for (let key in attrs) {\n      const newKey = key\n        .toLocaleLowerCase()\n        .replace('class', 'className')\n      \n      attrs[newKey] = attrs[key]\n    }\n  }\n \n  var elem = Object.assign(\n    document.createElement(tagName),\n    typeof attrs === 'object' ? attrs : {}\n  )\n\n  if (isSVG(tagName)) {\n    elem = document.createElementNS('http://www.w3.org/2000/svg', tagName)\n\n    for (const prop in attrs) {\n      if (attrs.hasOwnProperty(prop)) {\n        elem.setAttribute(prop, attrs[prop])\n      }\n    }\n  }\n\n  // Apply style\n  if (attrs && attrs.hasOwnProperty('style')) {\n    elem.style = objectToStyleString(attrs['style'])\n  }\n \n  // Append childrens\n  for (const child of children) {\n    if (Array.isArray(child)) elem.append(...child)\n    else elem.append(child)\n  }\n\n  return elem\n\n}\n","/**\n * Used for global store management\n * @param {Function} reducer \n */\nexport const useReducer = (reducer) => {\n  \n  let state, listeners = []\n\n  /**\n   * Get state\n   */\n  const getState = () => state\n\n  /**\n   * Dispatch a object to store reducer\n   * @param {object} action \n   */\n  const dispatch = action => {\n    state = reducer(state, action)\n    // console.log(listeners);\n    listeners.forEach(listener => listener())\n  }\n\n  /**\n   * Inject function that called on every mutation\n   * @param {Function} listener \n   */\n  const subscribe = listener => {\n    listeners.push(listener)\n    return () => {\n      listeners = listeners.filter(l => l !== listener)\n    }\n  }\n\n  // Initial dispatch\n  dispatch({})\n\n  return { getState, dispatch, subscribe }\n\n}\n","import { createElement } from './element.js'\nimport { useState as stateHook } from './hooks.js'\nexport { useReducer } from './reducer.js'\nexport const m = createElement\n\n// Global scope\nlet\n  __root,\n  __view,\n  __state = {},\n  __cursor = 0\n\n/**\n * Initial render / mount\n * @param {HTMLElement} root - Parent element\n * @param {HTMLElement} view - Component created by \"createElement\" function\n */\nexport const render = (root, view) => {\n  __root = root\n  __view = view\n\n  renderer(root, view());\n}\n\n/**\n * Render function\n * @param {HTMLElement} view - Rendered given Component\n */\nconst renderer = (root, view) => {\n  // Reset cursor after re-render\n  __cursor = 0\n\n  // Get props from element to be cached\n  const cacheProps = e => ({\n    id: e.id,\n    selectionStart: e.selectionStart,\n    selectionEnd: e.selectionEnd,\n    selectionDirection: e.selectionDirection,\n    scrollTop: e.scrollTop,\n    scrollLeft: e.scrollLeft\n  });\n\n  const focusedId = (document.activeElement || {id:''}).id;\n  const identifiedElements = Array.prototype.map.call(document.querySelectorAll('[id]'), cacheProps);\n\n  // Clear element before append\n  while (root.firstChild) root.removeChild(root.firstChild);\n  root.append(...Array.isArray(view) ? view : [view]);\n\n  identifiedElements.forEach(element => {\n    const newElement = document.getElementById(element.id);\n    if (newElement) {\n      // Preserve input focus on re-render using id\n      if(element.id === focusedId) newElement.focus();\n      Object.assign(newElement, element);\n    }\n  });\n};\n\n/**\n * State hook\n * @param {any} initialState \n */\nexport const useState = (initialState) => stateHook(\n  {\n    state: __state,\n    cursor: __cursor,\n    render: renderer,\n    root: __root,\n    view: __view,\n  },\n  initialState\n)\n","/**\n * State hook\n * @param {any} initialValue - Initial state value\n */\nexport function useState(instance, initialValue) {\n\n  let { cursor } = instance\n  const { state: __state, render, root, view } = instance\n\n  let currentCursor = cursor\n  cursor++\n\n  const state = {}\n  state[currentCursor] = __state[currentCursor] || initialValue\n\n  const setState = (newVal) => {\n    typeof newVal === 'function'\n      ? __state[currentCursor] = newVal(state[currentCursor]) // Use prev state in setter\n      : __state[currentCursor] = newVal\n    \n    state[currentCursor] = __state[currentCursor]\n    render(root, view())\n  }\n  \n  return [state[currentCursor], setState]\n}\n\n/**\n * useEffect called on every component render\n * @param {Function} callback \n */\nexport const useEffect = callback => callback()\n"],"names":["isSVG","tagName","patt","RegExp","some","tag","test","objectToStyleString","styles","Object","keys","map","prop","replace","toLowerCase","join","useReducer","__root","__view","reducer","state","listeners","dispatch","action","forEach","listener","getState","subscribe","push","filter","l","m","attrs","children","Array","isArray","key","newKey","toLocaleLowerCase","elem","assign","document","createElement","createElementNS","hasOwnProperty","setAttribute","style","child","append","__state","__cursor","render","root","view","renderer","focusedId","activeElement","id","identifiedElements","prototype","call","querySelectorAll","e","selectionStart","selectionEnd","selectionDirection","scrollTop","scrollLeft","firstChild","removeChild","element","newElement","getElementById","focus","useState","initialState","instance","initialValue","cursor","currentCursor","newVal","stateHook"],"mappings":"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"}